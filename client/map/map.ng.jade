//- p filteredEvents : {{ addmarkerposition }}
//-  $root.updateNewMarkerPosition(vm.mapSvc.draggableMarker.position)
.map-wrapper.flex-column.flex-auto
  //- div(ui-view='map')
  .angular-google-map-container
    .loader-container
      .loader
    gm-map(
      center="vm.mapSvc.map.center",
      zoom="vm.mapSvc.map.zoom",
      on-tilesloaded='vm.mapSvc.updateVisibleMarkers(map); $root.gmapLoaded(map)',
      on-dragend='vm.mapSvc.dragEnd(map);',
      on-zoom-changed='vm.mapSvc.mapZoomChange(map)',
    )
      gm-circle.my-position-marker(
        center='vm.mapSvc.myLocation.position',
        options="{radius: radius, fillColor: fillColor, strokeColor: '#005BB7'}"
      )
      gm-marker.add-marker(
        position='vm.mapSvc.draggableMarker.position',
        options='{draggable: vm.mapSvc.draggableMarker.draggable}',
        gm-address="{address:'vm.mapSvc.draggableMarker.address'}",
        on-drag='vm.draggableMarkerOnDrag(); vm.mapSvc.draggableMarker.position = marker.position',
        on-dragend='vm.mapSvc.map.center = marker.position',
        on-position_changed='vm.draggableMarkerChanged()',
        ng-show='vm.mapSvc.draggableMarker.visible'
      )
        gm-infowindow.drg-marker-info-window(
          options="{content: vm.mapSvc.draggableMarker.content}",
          ng-show='vm.mapSvc.draggableMarker.visible',
          on-domready ='vm.mapSvc.draggableMarker.onDomready(map)'
        )

      gm-marker.event-marker(
        ng-repeat='filteredEvent in vm.mapSvc.filteredEvents',
        position='filteredEvent.position',
        on-click='filteredEvent.showInfoClick=!filteredEvent.showInfoClick',
        on-mouseover='vm.mapSvc.markerMouseOver(filteredEvent); filteredEvent.showInfo = true',
        on-mouseout='vm.mapSvc.markerMouseOut(filteredEvent); filteredEvent.showInfo = false'
      )
        gm-infowindow(
          ng-show='filteredEvent.showInfo',
          options="{content: '<h3>{{ filteredEvent.name }}</h3><p>{{ filteredEvent.description }}</p>'}",
          on-domready ='vm.mapSvc.draggableMarker.onDomready(map)'
        )
