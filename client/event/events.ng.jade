form.form-inline.search-form.flex-column
  input#search(type="text", ng-model="query", placeholder="Rechercher...")
  .result-length {{ vm.mapSvc.filteredEvents.length }} résultat(s)
  .active-filters(ng-click='showFilters = !showFilters', ng-init='showFilters = false', ng-attr-title="{{ showFilters ? 'Masquer Filtres' : 'Afficher Filtres' }}")
    i.icon.ion-ios-settings
  .filters(ng-show='showFilters').flex-wrap
    //- TIME FILTER
    .range-filter.flex-wrap
      .range-label.flex-auto(
        ng-click='vm.timeFilter.infinite=false;vm.timeFilter.disabled=!vm.timeFilter.disabled',
        ng-class="{'disabled': vm.timeFilter.disabled}"
      ) Quand ?
      .range-selector.flex-auto(ng-if='!vm.timeFilter.disabled')
        rzslider(
          rz-slider-floor='0',
          rz-slider-ceil='30',
          rz-slider-high='vm.timeFilter.max',
          rz-slider-model='vm.timeFilter.min',
          rz-slider-always-show-bar='true'
        )
      .range-btns.flex-auto.flex-wrap(ng-if='!vm.timeFilter.disabled')
        .editable.range-value(
          ng-class="{'disabled': vm.timeFilter.disabled || vm.timeFilter.infinite}",
          ng-click='vm.timeFilter.infinite=false;vm.timeFilter.disabled=false',
        )
          div.flex
            | De
            input.flex-auto(type='text', name='timeFiltertMin', ng-model='vm.timeFilter.min')
            | à
            input.flex-auto(type='text', name='timeFilterMax', ng-model='vm.timeFilter.max')
            | jours
        .infinite.range-value(
          ng-click='vm.timeFilter.infinite=true;vm.timeFilter.disabled=false',
          ng-class="{'disabled': !vm.timeFilter.infinite}"
        )
          div.flex
            label(for='infiniteTimeFilter') &infin;
            input(
              name='infiniteTimeFilter',
              type='checkbox',
              ng-model='vm.timeFilter.infinite'
            )
    //- DISTANCE FILTER
    .range-filter.distance-range.flex-wrap
      .range-label.flex-auto(
        ng-click='vm.distanceFilter.inifinite=false;vm.distanceFilter.disabled=!vm.distanceFilter.disabled',
        ng-class="{'disabled': vm.distanceFilter.disabled}"
      ) Ou ?
      .range-selector.flex-auto(ng-if='!vm.distanceFilter.disabled')
        rzslider(
          rz-slider-floor='0',
          rz-slider-ceil='30',
          rz-slider-model='vm.distanceFilter.max',
          rz-slider-always-show-bar='true'
        )
      .range-btns.flex-auto.flex-wrap(ng-if='!vm.distanceFilter.disabled')
        .editable.range-value.flex(
          ng-class="{'disabled': vm.distanceFilter.disabled || vm.distanceFilter.infinite}",
          ng-click='vm.distanceFilter.infinite=false;vm.distanceFilter.disabled=false',
        )
          div.flex
            input(name='distanceSort', type='text', ng-model='vm.distanceFilter.max')
            label(for='distanceSort') Km
        .infinite.range-value.flex(
          ng-click='vm.distanceFilter.infinite=true;vm.distanceFilter.disabled=false',
          ng-class="{'disabled': !vm.distanceFilter.infinite}"
        )
          div.flex
            label(for='infiniteDistanceFilter') &infin;
            input(
              name='infiniteDistanceFilter',
              type='checkbox',
              ng-model='vm.distanceFilter.infinite'
            )
    //- .sorting
    //-   label(for="sort-order") Trier par ordre
    //-   select(ng-model="vm.orderProperty", name='sort-order')
    //-     option(value="1") Croissant
    //-     option(value="-1") Décroissant
.events-list-wrapper
  ul.events-list(ng-if='vm.mapSvc.events.length > 0')
    li.flex-column(
      ng-repeat="event in vm.mapSvc.filteredEvents = (vm.mapSvc.events | filter:query | distance:vm.distanceFilter:vm.mapSvc.myLocation.position | isVisibleEvent | time:vm.timeFilter)",
      ng-class="{'overflown': vm.isOverflown(event._id)}",
      ng-mouseover='vm.mapSvc.openWindow(event._id); displayPresence = true',
      ng-mouseleave='vm.mapSvc.closeWindow(event._id); displayPresence = false',
      id='event-{{event._id}}'
    )
      .content-wrapper.flex
        .event-pic-overlay.flex-auto(ui-sref="app.event({eventId: event._id, eventSlug: event.url})")
          img.event-pic(ng-src="{{ vm.url(event, 'thumbnail') }}")
        .price Gratuit
        a.delete(ng-click="vm.remove(event._id)", ng-show="$root.currentUser && $root.currentUser._id == event.owner") &#215;
        .content.flex-auto
          .infos.flex-column
            .title.flex
              h2
                a(ui-sref="app.event({eventId: event._id, eventSlug: event.url})") {{event.name}}
              span.badge.public(ng-if="event.public") Public
              span.badge.private(ng-if="!event.public") Privé
            .date(ng-if='event.beginDate')
              i.icon.ion-ios-calendar-outline
              span(ng-if='event.beginDate')  {{ event.beginDate | date}}
              span(ng-if='event.beginTime')  à {{ event.beginTime }}
            p.description {{ event.description }}
            //- div(ng-if="event.public")
            //-   | Everyone is invited
            div(ng-hide="$root.currentUser")
              i Enregistrez-vous pour vous inscrire à cet évenement.
            //- div
            //-   strong Participations :
            //-   |  Oui - {{ (event.rsvps | filter:{rsvp:"yes"}).length }}
            //-   | Peut-être - {{ (event.rsvps | filter:{rsvp:"maybe"}).length }}
            //-   | Non - {{ (event.rsvps | filter:{rsvp:"no"}).length }}
            //-   div(ng-repeat="rsvp in event.rsvps | filter:{rsvp:'yes'}")
            //-     | {{ vm.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
            //-   div(ng-repeat="rsvp in event.rsvps | filter:{rsvp:'maybe'}")
            //-     | {{ vm.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
            //-   div(ng-repeat="rsvp in event.rsvps | filter:{rsvp:'no'}")
            //-     | {{ vm.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
            //- ul(ng-if="!event.public")
            //-   | Users who haven't responded ({{ outstandingInvitations(event).length }}):
            //-   li(ng-repeat="invitedUser in outstandingInvitations(event)")
            //-     | {{ invitedUser | displayName }}
            p.creator
              small Ajouté par {{ vm.creator(event) | displayName }}
              //- small(am-time-ago='event.added')
            .presence(ng-if='($root.currentUser || vm.isOverflown(event._id)) && displayPresence')
              .presence-btns.inline-block.clearfix.m1
                button.left.btn.x-group-item.rounded-left(type='button', ng-click="vm.rsvp(event._id, 'yes')", ng-class="{'active': vm.myPresence(event, 'yes'), 'btn-outline ': !vm.myPresence(event, 'yes')}") Je viens !
                button.left.btn.x-group-item.not-rounded(type='button', ng-click="vm.rsvp(event._id, 'maybe')", ng-class="{'active': vm.myPresence(event, 'maybe'), 'btn-outline ': !vm.myPresence(event, 'maybe')}") Peut-être
                button.left.btn.x-group-item.rounded-right(type='button', ng-click="vm.rsvp(event._id, 'no')", ng-class="{'active': vm.myPresence(event, 'no'), 'btn-outline ': !vm.myPresence(event, 'no')}") Non désolé
